(s=>{s(document).ready(function(){s("#email_notifications").change(function(){s("#email_addresses").prop("disabled",!s(this).is(":checked"))}),s("#all_links, #set_number").change(function(){s("#number_of_links").prop("disabled",s("#all_links").is(":checked"))})}),s(document).on("click","#wpcbl-manual-scan",function(e){e.preventDefault(),console.log("Manual scan started...");e=klaviyo_wp_meta_sync_params.nonce,e={action:"wpcbl_broken_links_manual_scan",scan_page_url:klaviyo_wp_meta_sync_params.scanPageUrl,nonce:e};a(e).then(e=>{console.log(e),"object"==typeof e&&e.hasOwnProperty("success")&&e.success?"string"==typeof e.data?(s(".wpcbl-klaviyo-wp-meta-sync-links-table").html(e.data),s(".wpcbl_export_csv_wrap").show(),s(".wpcbl-klaviyo-wp-meta-sync-links-table .tablenav-pages a").each(function(){var e=new URL(s(this).attr("href")).searchParams.get("paged"),a=new URL(klaviyo_wp_meta_sync_params.scanPageUrl);a.searchParams.set("paged",e),s(this).attr("href",a.toString())})):console.error("Error: Unexpected AJAX response",e):console.error("Error: AJAX request failed",e)})}),s(document).on("click","#wpcbl-mark-as-fixed.not-fixed",function(e){e.preventDefault(),console.log("Mark as fixed started...");e=klaviyo_wp_meta_sync_params.nonce;let a=s(this);e={action:"wpcbl_broken_links_mark_as_fixed",nonce:e,link:a.data("link"),postId:a.data("post-id")};n(e).then(e=>{console.log(e),"object"==typeof e&&e.hasOwnProperty("success")&&e.success&&"boolean"==typeof e.data&&e.data&&(a.hasClass("fixed")?(a.removeClass("fixed").addClass("not-fixed").html("Mark as Fixed"),a.closest("tr").find(".column-type .status-type").removeClass("fixed").addClass("not-fixed").html("Broken")):(a.removeClass("not-fixed").addClass("fixed").html("Mark as Broken"),a.closest("tr").find(".column-type .status-type").html("Fixed").removeClass("not-fixed").addClass("fixed")))})}),s(document).on("click","#wpcbl-mark-as-fixed.fixed",function(e){e.preventDefault(),console.log("Mark as broken started...");e=klaviyo_wp_meta_sync_params.nonce;let a=s(this);e={action:"wpcbl_broken_links_mark_as_broken",nonce:e,link:a.data("link"),postId:a.data("post-id")};t(e).then(e=>{console.log(e),"object"==typeof e&&e.hasOwnProperty("success")&&e.success&&"boolean"==typeof e.data&&e.data&&(a.hasClass("fixed")?(a.removeClass("fixed").addClass("not-fixed").html("Mark as Fixed"),a.closest("tr").find(".column-type .status-type").removeClass("fixed").addClass("not-fixed").html("Broken")):(a.removeClass("not-fixed").addClass("fixed").html("Mark as Broken"),a.closest("tr").find(".column-type .status-type").removeClass("not-fixed").addClass("fixed").html("Fixed")))})}),s(document).on("click",".wpcbl-klaviyo-wp-meta-sync-faq-item input",function(e){s(this).is(":checked")?s(this).siblings("label").find(".sign").text("-"):s(this).siblings("label").find(".sign").text("+")});let t=async e=>{try{return await s.ajax({url:klaviyo_wp_meta_sync_params.ajaxUrl,type:"POST",data:e,beforeSend:function(){console.log("Before mark links as broken")},complete:function(){console.log("Complete")}})}catch(e){console.error("Error:",e.statusText)}},a=async e=>{try{return await s.ajax({url:klaviyo_wp_meta_sync_params.ajaxUrl,type:"POST",data:e,beforeSend:function(){console.log("Sending data..."),o("show"),s(".wpcbl-klaviyo-wp-meta-sync-links-table").html(""),s(".wpcbl_export_csv_wrap").hide()},complete:function(){console.log("Data sent."),o("hide")}})}catch(e){console.error("Error:",e.statusText)}},n=async e=>{try{return await s.ajax({url:klaviyo_wp_meta_sync_params.ajaxUrl,type:"POST",data:e,beforeSend:function(){console.log("Before mark links as broken")},complete:function(){console.log("Complete.")}})}catch(e){console.error("Error:",e.statusText)}},o=e=>{var a=s(".wpcbl-is-scanning");"show"===e?a.show():"hide"===e&&a.hide()}})(jQuery);